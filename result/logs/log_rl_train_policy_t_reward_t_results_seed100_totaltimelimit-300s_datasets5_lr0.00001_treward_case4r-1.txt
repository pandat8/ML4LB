nohup: ignoring input
./result/saved_models/rl/reinforce/setcovering/checkpoint_trained_reward3_simplepolicy_rl4lb_reinforce_trainset_setcovering-small_lr0.01_epochs7.pth
t_reward_type:  reward_t
total_time_limit =  10
initial_node_time_limit =  10
learning rate =  1e-05
epsilon =  0.0
miplib_39binary-small
firstsol
symmetric
seed: 100
cpu
5
Epoch 0
original problem has 2728 variables (1364 bin, 0 int, 0 impl, 1364 cont) and 1442 constraints
Instance:  miplib_39binary-2_transformed_aflow40b
N of variables: 2728
N of binary vars: 1364
N of constraints: 1442
Initial obj before LB: 8410.0
binary support:  39
MIP copies are created
incumbent solution is copied to MIP copies
LB round: 1 Solving time: 0.2269 Best Obj: 4974.0000 n_sols_subMIP: 3 K: 20 t_node: 10.0 self.div: 0 LB Status: optimal
/home/liudefen/projects/ML4LocalBranch_extend/models_rl.py:61: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = F.log_softmax(preds)
LB round: 2 Solving time: 5.3445 Best Obj: 2835.0000 n_sols_subMIP: 8 K: 20 t_node: 20.0 self.div: 0 LB Status: optimal
LB round: 3 Solving time: 10.0013 Best Obj: 2835.0000 n_sols_subMIP: 1 K: 30 t_node: 20.0 self.div: 0 LB Status: timelimit
K_final: 30 div_final: 0
Instance: miplib_39binary-2_transformed_aflow40b_GNN_reset
Status of LB:  unknown
Best obj of LB:  2835.0
Solving time:  10.001332999999999


instance:  0
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
original problem has 7195 variables (7195 bin, 0 int, 0 impl, 0 cont) and 714 constraints
Instance:  miplib_39binary-4_transformed_air05
N of variables: 7195
N of binary vars: 7195
N of constraints: 714
Initial obj before LB: 30740.0
binary support:  66
MIP copies are created
incumbent solution is copied to MILB round:LB round: 1 Solving time: 10.0021 Best Obj: 30740.0000 n_sols_subMIP: 2 K: 20 t_node: 10.0 self.div: 0 LB Status: timelimit
K_final: 20 div_final: 0
Instance: miplib_39binary-4_transformed_air05_GNN_reset
Status of LB:  unknown
Best obj of LB:  30740.0
Solving time:  10.002106


instance:  1
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
original problem has 8904 variables (8904 bin, 0 int, 0 impl, 0 cont) and 1069 constraints
Instance:  miplib_39binary-3_transformed_air04
N of variables: 8904
N of binary vars: 8904
N of constraints: 1069
Initial obj before LB: 57283.999999999985
binary support:  103
MIP copies are created
incumbent solution is copied to MIP copies
LB round: 1 Solving time: 10.0060 Best Obj: 57284.0000 n_sols_subMIP: 1 K: 20 t_node: 10.0 self.div: 0 LB Status: timelimit
K_final: 20 div_final: 0
Instance: miplib_39binary-3_transformed_air04_GNN_reset
Status of LB:  unknown
Best obj of LB:  57283.999999999985
Solving time:  10.005953


instance:  2
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
original problem has 3648 variables (192 bin, 0 int, 0 impl, 3456 cont) and 3312 constraints
Instance:  miplib_39binary-0_transformed_a1c1s1
N of variables: 3648
N of binary vars: 192
N of constraints: 3312
Initial obj before LB: 21141.52
binary support:  173
MIP copies are created
incumbent solution is copied to MIP copies
LB round: 1 Solving time: 10.0012 Best Obj: 18791.4790 n_sols_subMIP: 20 K: 20 t_node: 10.0 self.div: 0 LB Status: timelimit
K_final: 20 div_final: 0
Instance: miplib_39binary-0_transformed_a1c1s1_GNN_reset
Status of LB:  unknown
Best obj of LB:  18791.47900000002
Solving time:  10.001224


instance:  3
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
original problem has 842 variables (421 bin, 0 int, 0 impl, 421 cont) and 479 constraints
Instance:  miplib_39binary-1_transformed_aflow30a
N of variables: 842
N of binary vars: 421
N of constraints: 479
Initial obj before LB: 4374.0
binary support:  29
MIP copies are created
incumbent solution is copied to MIP copies
LB round: 1 Solving time: 0.9252 Best Obj: 1900.0000 n_sols_subMIP: 10 K: 20 t_node: 10.0 self.div: 0 LB Status: optimal
LB round: 2 Solving time: 1.0381 Best Obj: 1421.0000 n_sols_subMIP: 1 K: 10 t_node: 10.0 self.div: 0 LB Status: optimal
LB round: 3 Solving time: 6.0382 Best Obj: 1232.0000 n_sols_subMIP: 11 K: 15 t_node: 5.0 self.div: 0 LB Status: timelimit
LB round: 4 Solving time: 8.5383 Best Obj: 1232.0000 n_sols_subMIP: 10 K: 23 t_node: 2.5 self.div: 0 LB Status: timelimit
LB round: 5 Solving time: 9.7886 Best Obj: 1232.0000 n_sols_subMIP: 10 K: 20 t_node: 1.2 self.div: 0 LB Status: timelimit
LB round: 6 Solving time: 9.7957 Best Obj: 1232.0000 n_sols_subMIP: 9 K: 20 t_node: 0.6 self.div: 1 LB Status: sollimit
LB round: 7 Solving time: 10.0002 Best Obj: 1232.0000 n_sols_subMIP: 10 K: 20 t_node: 0.3 self.div: 1 LB Status: timelimit
K_final: 20 div_final: 1
Instance: miplib_39binary-1_transformed_aflow30a_GNN_reset
Status of LB:  unknown
Best obj of LB:  1232.0
Solving time:  10.000223


instance:  4
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
Return policy k: 0.930306
Return policy t: -0.778278
Primal ingtegral: 59.850459
Epoch 1
original problem has 2728 variables (1364 bin, 0 int, 0 impl, 1364 cont) and 1442 constraints
Instance:  miplib_39binary-2_transformed_aflow40b
N of variables: 2728
N of binary vars: 1364
N of constraints: 1442
Initial obj before LB: 8410.0
binary support:  39
MIP copies are created
incumbent solution is copied to MIP copies
LB round: 1 Solving time: 0.2350 Best Obj: 4974.0000 n_sols_subMIP: 3 K: 20 t_node: 10.0 self.div: 0 LB Status: optimal
/home/liudefen/projects/ML4LocalBranch_extend/models_rl.py:61: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  probs = F.log_softmax(preds)
LB round: 2 Solving time: 5.2355 Best Obj: 2434.0000 n_sols_subMIP: 10 K: 30 t_node: 5.0 self.div: 0 LB Status: timelimit
LB round: 3 Solving time: 7.7364 Best Obj: 2280.0000 n_sols_subMIP: 5 K: 20 t_node: 2.5 self.div: 0 LB Status: timelimit
LB round: 4 Solving time: 10.0008 Best Obj: 1536.0000 n_sols_subMIP: 6 K: 30 t_node: 10.0 self.div: 0 LB Status: timelimit
K_final: 30 div_final: 0
Instance: miplib_39binary-2_transformed_aflow40b_GNN_reset
Status of LB:  unknown
Best obj of LB:  1536.0
Solving time:  10.000758000000001


instance:  0
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
original problem has 8904 variables (8904 bin, 0 int, 0 impl, 0 cont) and 1069 constraints
Instance:  miplib_39binary-3_transformed_air04
N of variables: 8904
N of binary vars: 8904
N of constraints: 1069
Initial obj before LB: 57283.999999999985
binary support:  103
MIP copies are created
incumbent solution is copied to MIP copies
LB round: 1 Solving time: 10.0038 Best Obj: 57284.0000 n_sols_subMIP: 1 K: 20 t_node: 10.0 self.div: 0 LB Status: timelimit
K_final: 20 div_final: 0
Instance: miplib_39binary-3_transformed_air04_GNN_reset
Status of LB:  unknown
Best obj of LB:  57283.999999999985
Solving time:  10.003774


instance:  1
is
try to free MIP_model
MIP_model freed
try to delete instance
instance deleted
done
Traceback (most recent call last):
  File "train_reinforce4lb_t_policy.py", line 83, in <module>
    reinforce_localbranch.train_agent_policy_t(train_instance_size=instance_size,
  File "/home/liudefen/projects/ML4LocalBranch_extend/mllocalbranch_fromfiles.py", line 7513, in train_agent_policy_t
    agent_t, optimizer_t, R_t = self.update_agent(agent_t, optimizer_t)
  File "/home/liudefen/projects/ML4LocalBranch_extend/mllocalbranch_fromfiles.py", line 7138, in update_agent
    policy_losses = torch.cat(policy_losses).sum()
RuntimeError: There were no tensor arguments to this function (e.g., you passed an empty list of Tensors), but no fallback function is registered for schema aten::_cat.  This usually means that this function requires a non-empty list of Tensors.  Available functions are [CPU, CUDA, QuantizedCPU, BackendSelect, Named, AutogradOther, AutogradCPU, AutogradCUDA, AutogradXLA, AutogradPrivateUse1, AutogradPrivateUse2, AutogradPrivateUse3, Tracer, Autocast, Batched, VmapMode].

CPU: registered at /pytorch/build/aten/src/ATen/CPUType.cpp:2127 [kernel]
CUDA: registered at /pytorch/build/aten/src/ATen/CUDAType.cpp:2983 [kernel]
QuantizedCPU: registered at /pytorch/build/aten/src/ATen/QuantizedCPUType.cpp:297 [kernel]
BackendSelect: fallthrough registered at /pytorch/aten/src/ATen/core/BackendSelectFallbackKernel.cpp:3 [backend fallback]
Named: registered at /pytorch/aten/src/ATen/core/NamedRegistrations.cpp:7 [backend fallback]
AutogradOther: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
AutogradCPU: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
AutogradCUDA: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
AutogradXLA: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
AutogradPrivateUse1: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
AutogradPrivateUse2: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
AutogradPrivateUse3: registered at /pytorch/torch/csrc/autograd/generated/VariableType_2.cpp:8078 [autograd kernel]
Tracer: registered at /pytorch/torch/csrc/autograd/generated/TraceType_2.cpp:9654 [kernel]
Autocast: registered at /pytorch/aten/src/ATen/autocast_mode.cpp:258 [kernel]
Batched: registered at /pytorch/aten/src/ATen/BatchingRegistrations.cpp:511 [backend fallback]
VmapMode: fallthrough registered at /pytorch/aten/src/ATen/VmapModeRegistrations.cpp:33 [backend fallback]

